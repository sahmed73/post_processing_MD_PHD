# -*- coding: utf-8 -*-
"""
Created on Wed Aug 16 11:21:43 2023

@author: arup2
"""

import magnolia.bondfile_parser as bfp
import matplotlib.pyplot as plt
import numpy as np

directory    = r'C:\Users\arup2\OneDrive - University of California Merced\Desktop\LAMMPS\Antioxidants\ABCDE\B\B_300_O2\Production\200_Less_TempRamp_1150K'
filename     = '\\bonds.reaxc'
bondfilepath = directory+filename
atomsymbols  = ['H','C','O']
bondinfo = bfp.parsebondfile(bondfilepath, bo=True)
#%%
neighbours = bondinfo['neighbours']
bondorders = bondinfo['bondorders']
atypes     = bondinfo['atypes']
steps      = list(neighbours.keys())
firststepneigh = neighbours[steps[0]]

bonds = {}

for parent,children in firststepneigh.items():
    #O-H bond
    key = 'O-H'
    if atypes[parent]==3:
        for child in children:
            if atypes[child]==1:
                bond = (parent,child)
                if key in bonds:
                    bonds[key].append(bond)
                else:
                    bonds[key]=[]
    
    #tert-butyl
    key = 'tert-butyl'
    if atypes[parent]==2:
        ff = [atypes[x] for x in children].count(2)
        if ff==4:
            for child in children:
                fff = [atypes[x] for x in firststepneigh[child]].count(2)
                if fff==3:
                    bond = (parent,child)
                    if key in bonds:
                        bonds[key].append(bond)
                    else:
                        bonds[key]=[]
    
    #link
    key = 'link'
    if atypes[parent]==2:
        ff = [atypes[x] for x in children].count(2)
        if ff==3:
            for child in children:
                fff = [atypes[x] for x in firststepneigh[child]].count(2)
                if fff==3:
                    bond = (parent,child)
                    if key in bonds:
                        bonds[key].append(bond)
                    else:
                        bonds[key]=[]
    #C-H
    key = 'C-H'
    if atypes[parent]==1:
        for child in children:
            if atypes[child]==2:
                bond = (parent,child)
                if key in bonds:
                    bonds[key].append(bond)
                else:
                    bonds[key]=[]
                    
    #C=C
    key = 'C=C'
    if atypes[parent]==2:
        Noxy = [atypes[x] for x in children].count(3)
        Nhyd = [atypes[x] for x in children].count(1)
        if Noxy==1 and Nhyd==2:
            for child in children:
                if atypes[child]==2:
                    for schild in firststepneigh[child]:
                        if atypes[schild]==2 and schild!=parent:
                            bond = (schild,child)
                            if key in bonds:
                                bonds[key].append(bond)
                            else:
                                bonds[key]=[]
    
    # -OH
    key = '-OH'
    if atypes[parent]==3:
        for child in children:
            if atypes[child]==2:
                bond = (parent,child)
                if key in bonds:
                    bonds[key].append(bond)
                else:
                    bonds[key]=[]
    
    # -OH-1
    key = '-OH-1'
    keyy= '-OH-2'
    if atypes[parent]==3:
        for child in children:
            if atypes[child]==2:
                ff = [atypes[x] for x in firststepneigh[child]].count(2)
                bond = (parent,child)
                if ff==2:
                   if key in bonds:
                       bonds[key].append(bond)
                   else:
                       bonds[key]=[]
                else:
                    if keyy in bonds:
                        bonds[keyy].append(bond)
                    else:
                        bonds[keyy]=[]
    
    
    # key = 'OH-H'
    # for step,neigh in neighbours.items():
    #     for parent,children in neigh.items():
    #         if parent<=3200 and atypes[parent]==3:
    #             for child in children:
    #                 if [atypes[x] for x in children].count(1)==2:
    #                     bond = (parent,child)
    #                     if key in bonds:
    #                         bonds[key].append(bond)
    #                     else:
    #                         bonds[key]=[]

#%%

savebond = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 2, 1, 1, 0, 0, 1, 0, 1, 2, 1, 1, 2, 2, 2, 2, 0, 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 3, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 2, 3, 3, 3, 3, 3, 2, 2, 2, 3, 3, 1, 2, 2, 1, 2, 1, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 2, 3, 3, 2, 2, 2, 4, 4, 3, 4, 4, 4, 2, 3, 3, 3, 3, 3, 4, 3, 4, 3, 2, 4, 3, 4, 3, 3, 3, 2, 4, 4, 4, 4, 3, 4, 3, 3, 2, 4, 3, 3, 4, 3, 4, 2, 2, 3, 3, 2, 3, 3, 3, 2, 4, 2, 3, 3, 4, 3, 3, 2, 4, 4, 2, 4, 2, 4, 2, 2, 3, 3, 3, 4, 3, 2, 4, 2, 4, 2, 4, 4, 2, 4, 3, 2, 3, 4, 3, 4, 4, 4, 3, 4, 3, 2, 3, 4, 2, 3, 4, 4, 3, 4, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 5, 4, 5, 4, 5, 5, 5, 5, 4, 5, 4, 4, 4, 4, 5, 4, 5, 4, 4, 4, 2, 4, 3, 4, 4, 4, 4, 3, 4, 5, 4, 4, 4, 4, 4, 4, 6, 3, 4, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 4, 4, 3, 3, 5, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 4, 4, 3, 3, 4, 4, 4, 4, 4, 4, 4, 5, 4, 4, 4, 5, 5, 4, 5, 5, 4, 4, 5, 5, 3, 4, 4, 4, 4, 4, 4, 4, 5, 4, 4, 5, 4, 5, 5, 5, 4, 5, 5, 5, 4, 6, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 6, 5, 5, 6, 5, 6, 6, 5, 5, 4, 6, 5, 5, 6, 4, 6, 6, 5, 5, 4, 6, 6, 4, 5, 6, 4, 3, 5, 5, 5, 6, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 4, 5, 5, 5, 4, 4, 5, 3, 6, 2, 4, 5, 6, 4, 5, 6, 4, 5, 5, 6, 6, 4, 4, 6, 5, 5, 6, 4, 5, 3, 5, 4, 5, 4, 5, 5, 4, 6, 5, 5, 3, 5, 4, 6, 5, 6, 4, 4, 4, 4, 4, 6, 5, 5, 5, 5, 5, 5, 5, 6, 5, 5, 5, 6, 4, 5, 5, 4, 5, 5, 5, 5, 4, 6, 6, 6, 5, 6, 5, 3, 5, 4, 6, 5, 5, 6, 6, 4, 5, 5, 6, 5, 5, 6, 5, 5, 6, 5, 4, 6, 6, 5, 6, 5, 5, 4, 5, 5, 6, 6, 6, 5, 5, 4, 6, 5, 6, 4, 4, 6, 6, 5, 6, 6, 5, 6, 3, 6, 5, 5, 6, 5, 3, 4, 3, 5, 4, 4, 5, 5, 4, 5, 4, 4, 4, 5, 5, 4, 6, 5, 5, 4, 5, 6, 6, 6, 6, 6, 6, 5, 6, 4, 6, 6, 4, 6, 5, 5, 6, 5, 6, 5, 6, 6, 6, 6, 4, 6, 6, 5, 6, 6, 6, 5, 6, 4, 4, 6, 6, 4, 6, 5, 6, 5, 4, 6, 6, 6, 6, 6, 6, 5, 6, 6, 6, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 6, 8, 6, 6, 7, 7, 6, 6, 7, 8, 8, 8, 7, 8, 6, 6, 6, 8, 7, 7, 8, 7, 8, 8, 8, 8, 8, 7, 7, 8, 6, 8, 8, 9, 8, 8, 8, 9, 7, 9, 9, 8, 9, 8, 8, 8, 9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 10, 7, 8, 8, 9, 8, 9, 8, 9, 8, 9, 9, 9, 8, 8, 8, 10, 8, 6, 9, 7, 8, 8, 8, 8, 6, 7, 8, 8, 8, 8, 8, 7, 8, 6, 8, 7, 8, 8, 7, 8, 8, 9, 6, 7, 7, 8, 6, 7, 8, 8, 8, 8, 7, 7, 8, 8, 8, 8, 10, 9, 9, 9, 8, 9, 10, 8, 10, 8, 8, 7, 8, 10, 8, 8, 8, 9, 8, 10, 7, 8, 10, 8, 8, 8, 9, 10, 8, 10, 9, 10, 10, 10, 9, 10, 8, 8, 10, 10, 7, 10, 10, 10, 8, 10, 10, 11, 11, 10, 8, 9, 9, 9, 8, 8, 10, 7, 10, 10, 9, 9, 10, 8, 8, 9, 9, 8, 9, 8, 9, 10, 9, 8, 8, 5, 9, 8, 10, 9, 9, 10, 8, 8, 8, 8, 8, 9, 8, 10, 9, 7, 10, 10, 7, 8, 8, 8, 10, 10, 10, 8, 8, 9, 8, 10, 8, 10, 10, 11, 9, 10, 8, 11, 9, 11, 8, 9, 10, 8, 10, 9, 11, 8, 10, 9, 9, 10, 7, 10, 12, 11, 12, 13, 10, 12, 9, 10, 12, 12, 12, 12, 11, 10, 11, 10, 12, 10, 10, 10, 10, 8, 9, 10, 9, 8, 9, 10, 10, 10, 9, 10, 10, 11, 8, 10, 10, 10, 8, 11, 10, 11, 11, 10, 12, 8, 10, 12, 12, 13, 12, 10, 10, 11, 12, 12, 12, 12, 10, 10, 11, 13, 12, 14, 12, 12, 10, 13, 12, 12, 13, 12, 13, 14, 14, 12, 12, 12, 12, 10, 13, 14, 12, 14, 14, 14, 14, 11, 14, 13, 14, 14, 14, 14, 13, 13, 12, 14, 15, 14, 12, 12, 14, 13, 13, 13, 14, 15, 16, 14, 12, 13, 15, 14, 14, 16, 13, 12, 14, 12, 13, 13, 14, 13, 14, 13, 14, 12, 13, 14, 15, 14, 13, 16, 14, 14, 14, 12, 15, 15, 14, 15, 13, 14, 14, 14, 14, 13, 14, 15, 14, 12, 15, 14, 14, 14, 14, 16, 14, 14, 14, 15, 15, 13, 14, 14, 14, 12, 13, 15, 12, 14, 14, 14, 14, 12, 13, 14, 13, 13, 13, 13, 12, 14, 14, 12, 15, 13, 14, 14, 13, 12, 14, 14, 14, 14, 15, 14, 14, 14, 14, 15, 12, 15, 16, 16, 14, 14, 14, 14, 17, 14, 16, 15, 16, 15, 16, 17, 16, 15, 18, 17, 16, 16, 19, 14, 17, 17, 16, 17, 17, 18, 16, 17, 17, 16, 16, 16, 18, 16, 17, 17, 18, 16, 16, 18, 21, 16, 19, 17, 20, 18, 18, 17, 20, 18, 20, 18, 21, 18, 20, 18, 19, 20, 20, 20, 16, 18, 19, 20, 20, 18, 17, 20, 18, 20, 19, 20, 20, 20, 20, 19, 20, 18, 19, 18, 19, 19, 18, 20, 17, 18, 16, 18, 20, 18, 20, 18, 21, 19, 16, 19, 21, 19, 20, 20, 20, 19, 21, 20, 22, 20, 20, 18, 18, 18, 20, 18, 16, 19, 18, 19, 18, 18, 20, 18, 20, 19, 20, 19, 20, 19, 20, 19, 21, 18, 22, 20, 20, 20, 18, 24, 21, 20, 20, 22, 22, 21, 22, 22, 22, 22, 22, 22, 23, 22, 22, 22, 22, 21, 22, 20, 20, 21, 22, 20, 22, 21, 24, 22, 22, 21, 22, 24, 21, 20, 24, 24, 21, 20, 21, 20, 22, 20, 21, 22, 24, 21, 22, 20, 23, 22, 20, 21, 22, 22, 22, 22, 23, 22, 22, 20, 24, 22, 22, 22, 24, 23, 24, 22, 24, 22, 22, 21, 21, 22, 22, 24, 22, 17, 19, 19, 23, 19, 20, 21, 22, 21, 21, 22, 22, 21, 22, 21, 20, 21, 22, 21, 20, 20, 18, 18, 20, 20, 23, 20, 22, 22, 22, 19, 20, 22, 22, 22, 21, 21, 23, 23, 25, 24, 24, 24, 22, 24, 22, 21, 22, 22, 22, 23, 22, 22, 20, 21, 22, 20, 20, 20, 22, 20, 21, 21, 22, 22, 24, 22, 22, 21, 23, 20, 22, 22, 24, 22, 22, 22, 22, 20, 24, 23, 24, 24, 24, 23, 22, 25, 24, 24, 24, 22, 21, 21, 24, 26, 23, 24, 24, 24, 24, 23, 26, 24, 22, 22, 26, 28, 26, 24, 25, 26, 24, 27, 25, 25, 26, 28, 26, 25, 28, 26, 28, 26, 28, 26, 26, 28, 30, 28, 27, 28, 27, 28, 26, 27, 30, 27, 28, 30, 29, 26, 27, 28, 25, 28, 27, 29, 25, 27, 27, 27, 28, 25, 26, 27, 28, 28, 23, 29, 28, 28, 28, 29, 30, 29, 26, 26, 28, 28, 28, 28, 29, 24, 27, 28, 28, 31, 27, 29, 28, 27, 29, 30, 27, 28, 28, 28, 28, 28, 28, 29, 30, 28, 27, 29, 30, 30, 28, 29, 30, 30, 29, 30, 28, 30, 30, 28, 26, 30, 29, 30, 30, 29, 30, 28, 28, 28, 28, 28, 30, 27, 28, 30, 30, 30, 30, 31, 29, 28, 30, 30, 30, 28, 29, 30, 29, 30, 30, 29, 30, 30, 30, 30, 32, 32, 28, 30, 32, 30, 32, 30, 32, 30, 32, 31, 32, 30, 29, 29, 29, 30, 30, 30, 30, 29, 30, 33, 31, 32, 28, 33, 29, 30, 32, 32, 32, 32, 31, 29, 28, 29, 31, 33, 32, 30, 31, 29, 32, 32, 30, 32, 33, 32, 34, 29, 31, 33, 32, 29, 34, 30, 32, 27, 30, 32, 32, 32, 31, 30, 28, 31, 32, 32, 32, 33, 28, 32, 34, 32, 34, 29, 34, 34, 32, 31, 33, 33, 33, 34, 32, 34, 32, 34, 34, 31, 30, 36, 34, 34, 33, 33, 32, 32, 32, 32, 32, 34, 34, 30, 34, 34, 32, 34, 34, 29, 31, 32, 33, 34, 30, 30, 32, 32, 29, 34, 34, 32, 35, 30, 34, 32, 34, 32, 32, 31, 32, 32, 30, 33, 35, 31, 34, 32, 31, 30, 32, 30, 33, 35, 32, 34, 32, 33, 34, 32, 36, 36, 34, 33, 34, 34, 35, 32, 36, 34, 34, 36, 32, 34, 37, 35, 36, 33, 36, 36, 37, 36, 34, 35, 37, 37, 34, 36, 35, 39, 30, 37, 38, 37, 35, 36, 37, 36, 35, 38, 38, 36, 36, 35, 36, 36, 35, 38, 35, 37, 36, 37, 37, 38, 38, 36, 37, 35, 38, 36, 38, 36, 37, 38, 40, 35, 36, 38, 38, 40, 42, 37, 37, 38, 36, 36, 36, 36, 37, 36, 38, 40, 36, 36, 37, 38, 38, 37, 37, 36, 37, 40, 37, 36, 36, 36, 37, 38, 38, 38, 36, 37, 38, 36, 40, 38, 37, 38, 40, 38, 39, 34, 38, 36, 38, 38, 37, 38, 36, 37, 34, 39, 39, 37, 39, 39, 38, 40, 40, 40, 38, 39, 39, 40, 36, 38, 39, 40, 37, 40, 36, 38, 36, 40, 38, 37, 39, 39, 40, 38, 39, 39, 38, 41, 40, 38, 37, 40, 36, 39, 36, 39, 39, 40, 38, 37, 38, 39, 36, 39, 39, 40, 40, 40, 42, 39, 39, 38, 36, 37, 40, 43, 38, 39, 39, 40, 40, 42, 43, 41, 40, 38, 42, 37, 40, 38, 41, 38, 40, 42, 42, 39, 41, 44, 40, 38, 40, 40, 42, 42, 44, 43, 40, 43, 42, 43, 43, 39, 43, 42, 43, 44, 44, 44, 44, 44, 40, 40, 40, 43, 43, 42, 44, 43, 42, 44, 41, 42, 43, 42, 42, 40, 44, 44, 44, 42, 42, 43, 43, 46, 44, 46, 42, 40, 44, 40, 42, 43, 42, 44, 42, 44, 46, 42, 42, 45, 42, 44, 43, 45, 43, 44, 45, 44, 41, 44, 42, 44, 43, 42, 43, 44, 44, 44, 42, 40, 44, 47, 44, 43, 45, 44, 43, 44, 45, 46, 46, 43, 43, 42, 40, 46, 43, 44, 42, 44, 42, 44, 42, 44, 46, 47, 42, 44, 42, 44, 42, 45, 44, 44, 44, 42, 42, 42, 42, 43, 39, 42, 42, 43, 40, 42, 43, 42, 42, 42, 44, 43, 43, 45, 38, 45, 45, 46, 42, 46, 47, 46, 46, 47, 44, 45, 46, 48, 46, 45, 45, 46, 48, 50, 44, 48, 46, 44, 48, 44, 44, 44, 46, 45, 44, 44, 42, 42, 48, 47, 45, 43, 44, 43, 46, 44, 46, 44, 46, 48, 47, 50, 48, 50, 45, 46, 50, 47, 50, 50, 47, 49, 48, 44, 46, 47, 48, 46, 45, 46, 46, 45, 47, 46, 45, 48, 47, 50, 48, 48, 48, 48, 45, 47, 46, 47, 44, 46, 47, 50, 48, 44, 47, 48, 48, 45, 48, 49, 48, 49, 48, 46, 46, 47, 50, 50, 49, 46, 48, 46, 49, 47, 48, 46, 46, 46, 45, 44, 44, 48, 50, 47, 49, 45, 50, 52, 47, 45, 49, 48, 44, 46, 47, 46, 48, 49, 46, 47, 49, 50, 44, 47, 46, 46, 50, 51, 48, 46, 52, 50, 50, 52, 52, 50, 52, 48, 48, 50, 48, 51, 52, 50, 47, 48, 46, 50, 45, 50, 49, 48, 48, 49, 48, 51, 45, 50, 46, 48, 48, 46, 49, 50, 48, 50, 50, 50, 49, 47, 47, 49, 47, 46, 51, 52, 50, 49, 50, 52, 48, 48, 46, 48, 48, 48, 50, 46, 46, 48, 50, 47, 49, 51, 49, 50, 51, 50, 52, 51, 52, 50, 49, 50, 49, 44, 50, 50, 48, 46, 48, 48, 52, 49, 48, 48, 50, 49, 50, 48, 51, 49, 48, 49, 43, 48, 51, 49, 49, 52, 48, 48, 49, 48, 52, 51, 49, 51, 50, 51, 48, 51, 50, 51, 52, 50, 50, 50, 48, 50, 52, 49, 49, 52, 48, 51, 51, 50, 52, 50, 49, 52, 50, 51, 49, 50, 51, 50, 52, 52, 50, 49, 50, 52, 52, 50, 50, 51, 50, 52, 50, 52, 49, 50, 52, 50, 53, 53, 50, 53, 54, 53, 52, 52, 52, 52, 52, 51, 52, 51, 48, 52, 52, 54, 52, 53, 52, 53, 51, 53, 50, 52, 51, 53, 52, 50, 50, 51, 50, 51, 50, 51, 48, 53, 50, 51, 49, 52, 54, 55, 52, 53, 48, 53, 54, 49, 55, 55, 52, 52, 53, 52, 51, 54, 53, 51, 53, 52, 52, 53, 54, 50, 53, 52, 56, 51, 51, 56, 51, 54, 55, 53, 54, 52, 51, 50, 49, 50, 50, 54, 52, 54, 51, 53, 56, 54, 55, 54, 52, 54, 52, 49, 54, 52, 54, 56, 52, 54, 56, 55, 53, 56, 52, 56, 54, 53, 54, 56, 56, 56, 52, 56, 57, 56, 58, 58, 58, 55, 56, 55, 55, 52, 54, 55, 54, 56, 56, 58, 56, 58, 58, 56, 54, 55, 57, 59, 59, 55, 56, 56, 54, 55, 54, 56, 57, 53, 52, 52, 55, 58, 54, 58, 62, 58, 58, 59, 57, 57, 51, 56, 58, 53, 58, 60, 56, 60, 55, 57, 56, 58, 55, 56, 56, 55, 58, 57, 57, 53, 57, 54, 56, 60, 57, 58, 55, 57, 59, 54, 58, 56, 56, 56, 59, 56, 58, 56, 56, 58, 59, 59, 57, 60, 55, 58, 59, 58, 58, 54, 58, 60, 57, 62, 58, 58, 56, 60, 58, 54, 59, 58, 59, 59, 62, 59, 59, 59, 60, 58, 59, 58, 60, 60, 57, 57, 57, 59, 59, 56, 56, 56, 55, 59, 58, 60, 56, 58, 57, 59, 57, 54, 59, 58, 57, 58, 58, 59, 58, 59, 55, 57, 61, 60, 60, 56, 58, 58, 53, 58, 58, 58, 60, 58, 56, 57, 59, 57, 59, 62, 58, 56, 60, 56, 57, 58, 62, 60, 59, 60, 61, 56, 57, 58, 60, 60, 60, 59, 59, 60, 60, 61, 64, 61, 60, 63, 60, 60, 58, 60, 60, 58, 58, 60, 60, 60, 56, 61, 60, 58, 60, 65, 60, 60, 64, 65, 64, 65, 61, 62, 64, 62, 62, 62, 63, 62, 62, 64, 59, 61, 62, 62, 61, 61, 62, 64, 63, 64, 64, 62, 63, 62, 64, 65, 65, 65, 62, 64, 68, 65, 66, 64, 64, 63, 63, 62, 59, 65, 62, 64, 61, 62, 64, 60, 66, 64, 64, 65, 64, 64, 64, 64, 64, 63, 59, 65, 62, 67, 62, 65, 64, 61, 62, 62, 60, 63, 63, 65, 65, 70, 62, 69, 69, 70, 67, 64, 68, 70, 68, 60, 69, 66, 66, 66, 68, 67, 66, 69, 66, 66, 69, 68, 71, 67, 66, 65, 67, 68, 66, 67, 69, 68, 67, 64, 64, 68, 66, 68, 68, 68, 67, 68, 66, 70, 69, 70, 66, 68, 67, 68, 63, 70, 71, 68, 70, 69, 67, 70, 66, 67, 64, 69, 68, 70, 71, 68, 69, 64, 69, 66, 67, 66, 67, 67, 71, 68, 66, 66, 65, 68, 68, 67, 66, 67, 67, 69, 70, 68, 66, 71, 69, 68, 69, 69, 70, 68, 70, 72, 69, 71, 70, 73, 66, 70, 72, 70, 70, 67, 65, 70, 70, 71, 67, 71, 72, 69, 70, 66, 70, 69, 66, 68, 70, 68, 69, 68, 66, 70, 70, 62, 66, 67, 69, 70, 66, 68, 69, 71, 68, 70, 68, 69, 70, 70, 68, 70, 69, 72, 69, 68, 68, 73, 65, 70, 73, 71, 71, 69, 69, 68, 68, 66, 74, 73, 68, 67, 68, 66, 66, 70, 72, 70, 70, 70, 72, 68, 74, 70, 68, 67, 68, 67, 67, 71, 74, 72, 70, 76]

import magnolia.needless_essential as ne
marker = ['s','^','x','o','>','*']
color    = ['b','c','m','r','g','grey']
cutoff = 1
tol    = 0.4
skipts = 0#(1150-300)/4
markevery = 150

bondname = {'O-H':'Bond-1 dissociation',
            '-OH':'Bond-2 dissociation',
            'link':'Bond-3 dissociation',
            'C=C':'Bond-4 dissociation',
            'HO-H': 'HO-H bond formation'
            #'tert-butyl':'NoNeed'
            }
# color = dict(zip(bondname.keys(),color))

for i,key in enumerate(bondname.keys()):
    if key in ['C-H']: continue
    if key in ['C=C']:
        cutoff = 1.5
        tol    = 0.4
    
    if key== 'HO-H': booond = bonds['O-H']
    else: booond = bonds[key]
    ps, nbonds = bfp.get_nbondsVStime(bondorders, atypes, booond,
                                      skipts=skipts,cutoff=cutoff, tol=tol)
    
    if key== 'HO-H':
        nbonds = savebond
        nbonds = [0]*(4850-4001)+nbonds
    plt.plot(ps,nbonds,label=bondname[key],marker=marker[i],
             markevery=markevery,markersize=4,linewidth=0.8,
             color=color[i])

###-plot-####
d = directory[directory.find('LAMMPS')+7:]
title = d[d.find('\\')+1:]+'\n'+'Molecule B\n'
plt.title(title)
#plt.title('Number of bond vs time {}'.format(bond_type))
plt.legend(bbox_to_anchor=(1,1))
plt.xlabel('Time (ps)')
plt.ylabel('Number of bonds')
# plt.xlim(right=1150)
savedir = r'C:\Users\arup2\OneDrive - University of California Merced\Desktop\LAMMPS\Post Processing\lammps_processing\python_outputs\bondplot'
# plt.grid('on')
plt.savefig(savedir+'//_B-'+ne.randstr(), dpi=300,bbox_inches='tight')